(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bd327926"],{"1ee3":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.isVisibleChangePassw?s("div",{staticClass:"auth-wrapper aut-bg-img-side cotainer-fiuid align-items-stretch"},[s("div",{staticClass:"row align-items-center w-100 align-items-stretch bg-white"},[s("div",{staticClass:"d-none d-lg-flex col-lg-8 login-img-bg align-items-center d-flex justify-content-center"},[s("div",{staticClass:"col-md-8"},[s("h5",{staticClass:"text-white mb-5"},[e._v(" ")]),e.loginFirst?s("h5",{staticClass:"text-white mb-5"},[e._v("Hemos detectado que es la primera vez que ingresas."),s("br"),e._v(" Por seguridad, "),s("b",[e._v("Favor de cambiar su contraseña")]),e._v(", para continuar.")]):e._e()])]),s("div",{staticClass:"col-lg-4 align-items-stret h-100 align-items-center d-flex justify-content-center"},[s("div",{staticClass:" auth-content text-center"},[s("div",{staticClass:"mb-4"},[s("img",{staticClass:"img-fluid",attrs:{src:e.logoGet+"logo.png"}})]),s("h3",{staticClass:"mb-4"},[e._v("Cambiar contraseña")]),s("form",{attrs:{autocomplete:"off"},on:{submit:function(e){e.preventDefault()}}},[s("div",{staticClass:"col-md-12"},[s("config-input",{attrs:{id:"passw",label:"null",typeinput:"password",placeholder:"Contraseña nueva",required:"true"},model:{value:e.passw,callback:function(t){e.passw="string"===typeof t?t.trim():t},expression:"passw"}})],1),s("div",{staticClass:"col-md-12"},[s("config-input",{attrs:{id:"confirmPassw",label:"null",typeinput:"password",placeholder:"Confirma contraseña",required:"true"},model:{value:e.confirmPassw,callback:function(t){e.confirmPassw="string"===typeof t?t.trim():t},expression:"confirmPassw"}}),s("div",{attrs:{id:"alertas"}})],1),s("button",{staticClass:"btn btn-primary shadow-2 mb-4",on:{click:function(t){return e.savePassword()}}},[e._v("GUARDAR")])]),e._m(0)])])])]):e._e()])},r=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"row"},[s("div",{staticClass:"col-sm-12",staticStyle:{"text-align":"justify",color:"#888"}},[s("p",[s("b",[e._v("Nota: ")]),e._v(" La contraseña debe contener como minimo 8 caracteres (entre ellos: mayúsculas, minúculas, números y caracteres especiales (.-#$&%))")])])])}],n=(s("96cf"),s("3b8d")),i=s("6f2c"),o=s("47a7"),c=s("da30"),l={name:"FormularioRecuperarContrasenia",mixins:[i["a"],o["a"],c["a"]],data:function(){return{passw:"",confirmPassw:"",token:this.$route.params.token,userRecover:"",visibleChangePassw:!1,Getlogo:localStorage.getItem("imgLogo")}},mounted:function(){this.validateToken(),this.Getlogo=localStorage.getItem("imgLogo")},methods:{validateToken:function(){var e=this,t={url:this.$store.state.apiUrl,token:this.token};this.isValidateToken(t).then(function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(s){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:!0===s.success?e.visibleChangePassw=!0:e.$router.push({name:"errorValidate"});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){console.log("error",e)}))},savePassword:function(){var e=this;if(""!==this.passw&&""!==this.confirmPassw){this.$store.state.loader=!0;var t=this.ValidatePassword(this.passw,this.confirmPassw);if(console.debug(t),1===t){var s={password:this.passw,url:this.$store.state.apiUrl,token:this.token};this.changePassword(s).then(function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(s){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!0!==s.success){t.next=7;break}return e.userRecover=s.data.user,$("#alertas").html("<div class='alert alert-success alert-dismissible fade show' role='alert' style='text-align: initial;'><strong>excelente! </strong>Se ha cambiado la contraseña <button type='button' class='close' data-dismiss='alert' aria-label='Close' style='padding-top: 0px;'><span aria-hidden='true'>&times;</span></button></div>"),t.next=5,setTimeout(e.redirecPage(),7e3);case 5:t.next=9;break;case 7:e.$store.state.loader=!1,$("#alertas").html("<div class='alert alert-danger alert-dismissible fade show' role='alert' style='text-align: initial;'><strong>Error! </strong>"+s.error.message+"<button type='button' class='close' data-dismiss='alert' aria-label='Close' style='padding-top: 0px;'><span aria-hidden='true'>&times;</span></button></div>");case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){console.log("error",e)}))}0===t&&(this.$store.state.loader=!1,$("#alertas").html("<div class='alert alert-danger alert-dismissible fade show' role='alert' style='text-align: initial;'><strong>Error! </strong>La contraseña debe contener como minimo 8 caracteres (entre ellos: mayúsculas, minúculas, números y caracteres especiales) <button type='button' class='close' data-dismiss='alert' aria-label='Close' style='padding-top: 0px;'><span aria-hidden='true'>&times;</span></button></div>")),2===t&&(this.$store.state.loader=!1,$("#alertas").html("<div class='alert alert-danger alert-dismissible fade show' role='alert' style='text-align: initial;'><strong>Error! </strong>Las constraseñas no coinciden <button type='button' class='close' data-dismiss='alert' aria-label='Close' style='padding-top: 0px;'><span aria-hidden='true'>&times;</span></button></div>"))}},redirecPage:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,s,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("entraredirec",sessionStorage.firstLogin),void 0===sessionStorage.firstLogin){e.next=19;break}if("true"!==sessionStorage.firstLogin&&!0!==sessionStorage.firstLogin){e.next=15;break}return console.debug("redirecHome"),this.$store.dispatch("showMenu",!0),this.sessionSet("logged",!0),t={session:{isFirstTimeLogin:sessionStorage.firstLogin,userType:sessionStorage.UT,clientType:sessionStorage.TC}},e.next=9,this.$store.dispatch("SuccessLogin",t);case 9:return e.next=11,this.$store.dispatch("loginFirstTime",!1);case 11:this.$store.state.loader=!1,this.$router.push({name:"home"}),e.next=17;break;case 15:this.$store.state.loader=!1,this.$router.push({name:"home"});case 17:e.next=22;break;case 19:console.debug("redirecHomeEmail"),s={user:this.userRecover,password:this.passw,url:"https://gpsinfinity.mx/api/"},this.login(s).then(function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var s,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!0!==t.success){e.next=32;break}return a.sessionSet("token",t.data.session.token),a.sessionSet("timezone",t.data.session.timezone),a.sessionSet("loginFist",t.data.session.isFirstTimeLogin),a.sessionSet("client",t.data.session.client),a.sessionSet("user",t.data.session.user),sessionStorage.setItem("firstLogin",t.data.session.isFirstTimeLogin),sessionStorage.setItem("TC",t.data.session.clientType),sessionStorage.setItem("UT",t.data.session.userType),e.next=11,a.getlogoUser_login(a.user);case 11:return e.sent,a.Getlogo=localStorage.getItem("imgLogo"),a.$store.state.modaloader.Getlogo=a.Getlogo,e.next=16,a.$store.commit("menuOptions",t.data.session.permissions);case 16:return e.next=18,a.$store.dispatch("devices/LOAD_DEVICES",t.data.devices);case 18:return s=t.data.fleets,e.next=21,a.$store.dispatch("devices/LOAD_FLEETS",s);case 21:return a.$store.state.devices.fleets.push({id:null,name:"SIN ASIGNAR",selected:!1,iconCollapse:!0}),e.next=24,a.$store.dispatch("SuccessLogin",t.data);case 24:return a.sessionSet("logged",!0),a.$store.dispatch("showMenu",!0),e.next=28,a.$store.dispatch("loginFirstTime",!1);case 28:a.$store.state.loader=!1,a.$router.push({name:"home"}),e.next=46;break;case 32:a.$store.state.loader=!1,r="",e.t0=t.error.title,e.next="PROVIDER_SUSPEND"===e.t0?37:"ACCOUNT_SUSPEND"===e.t0?39:"USER_SUSPEND"===e.t0?41:43;break;case 37:return r="El PROVEEDOR de servicio se encuentra suspendido, por favor comunicate con él para poder acceder a la plataforma.",e.abrupt("break",45);case 39:return r="La CUENTA se encuentra suspendida, por favor comunicate con soporte.",e.abrupt("break",45);case 41:return r="El USUARIO se encuentra suspendido, por favor comunicate con soporte.",e.abrupt("break",45);case 43:return r="El usuario/contraseña son incorrectos.",e.abrupt("break",45);case 45:$("#alertas").html("<div class='alert alert-danger alert-dismissible fade show' role='alert' style='text-align: initial;'><strong>Error! </strong>"+r+"<button type='button' class='close' data-dismiss='alert' aria-label='Close' style='padding-top: 0px;'><span aria-hidden='true'>&times;</span></button></div>");case 46:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log("error",e)}));case 22:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},computed:{logoGet:function(){return this.Getlogo},loginFirst:function(){return this.$store.getters.getloginFirstTime},isVisibleChangePassw:function(){return this.visibleChangePassw}}},u=l,d=(s("c4f6"),s("2877")),m=Object(d["a"])(u,a,r,!1,null,null,null);t["default"]=m.exports},"47a7":function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var a={data:function(){return{}},methods:{ValidatePassword:function(e,t){if(e===t){if(e.length>=8){for(var s=!1,a=!1,r=!1,n=!1,i=0;i<e.length;i++)e.charCodeAt(i)>=65&&e.charCodeAt(i)<=90?s=!0:e.charCodeAt(i)>=97&&e.charCodeAt(i)<=122?a=!0:e.charCodeAt(i)>=48&&e.charCodeAt(i)<=57?r=!0:(e.charCodeAt(i)>=35&&e.charCodeAt(i)<=38||e.charCodeAt(i)>=45&&e.charCodeAt(i)<=46)&&(n=!0);if(1==s&&1==a&&1==n&&1==r)return 1}return 0}return 2}}}},6874:function(e,t,s){},"6f2c":function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var a=s("bc3a"),r=s.n(a),n=(s("08e6"),{data:function(){return{}},methods:{isValidateToken:function(e){var t={token:e.token};return new Promise((function(s,a){r.a.get(e.url+"tokens/validate",{params:t}).then((function(e){s(e.data)})).catch((function(e){s(e)}))}))},login:function(e){var t={user:e.user,password:e.password};return new Promise((function(s,a){r.a.get(e.url+"login",{params:t}).then((function(e){s(e.data)})).catch((function(e){s(e)}))}))},recover:function(e){var t={email:e.email};return new Promise((function(s,a){r.a.get(e.url+"login/recover",{params:t}).then((function(e){console.log("api"),console.log(e),s(e.data)})).catch((function(e){s(e)}))}))},changePassword:function(e){r.a.defaults.headers.common["Authorization"]="Bearer "+e.token;var t={password:e.password};return new Promise((function(s,a){r.a.put(e.url+"login/password",t).then((function(e){s(e.data)})).catch((function(e){s(e)}))}))}}})},c4f6:function(e,t,s){"use strict";var a=s("6874"),r=s.n(a);r.a}}]);
//# sourceMappingURL=chunk-bd327926.38326e03.js.map