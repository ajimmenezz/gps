(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ab7d87a8"],{6624:function(e,t,s){"use strict";var i=s("d0f9"),r=s.n(i);r.a},d0f9:function(e,t,s){},ec51:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"card-body float-left row"},[e._m(0),e._m(1),s("div",{staticClass:"col-12"},[s("config-text-typography",{attrs:{texto:"Asignar permisos:"}}),s("select",{staticClass:"js-example-basic-multiple col-sm-12",attrs:{id:"permisos",multiple:"multiple"}},e._l(e.listPermissions,(function(t){return s("option",{key:t.id,domProps:{value:t.id}},[e._v(e._s(t.name))])})),0),1==this.$store.state.clientType?s("div",{staticClass:"text-muted",staticStyle:{"margin-top":"20px","text-align":"justify","font-size":"12px"}},[s("b",[e._v("Nota: ")]),e._v("Los usuarios  tendran por default asignados los permiso de: "),s("br"),s("span",{staticClass:"badge badge-secondary",staticStyle:{"font-size":"11px !important"}},[e._v("SECCION LOCALIZACIÓN")]),e._v(" \n                                    "),s("span",{staticClass:"badge badge-secondary",staticStyle:{"font-size":"11px !important","margin-bottom":"10px"}},[e._v("GESTION DE GEOCERCAS Y PI")])]):e._e()],1),1==this.$store.state.clientType?s("div",{staticClass:"row"},[e._m(2),e._m(3),s("div",{staticClass:"col-12"},[s("button",{staticClass:"btn btn-primary   m-b-10",staticStyle:{padding:"4px 11px","font-size":"14px"},attrs:{id:"addAllDevice",type:"button"},on:{click:e.agregarTodos}},[e._v("Seleccionar todos")]),s("button",{staticClass:"btn btn-primary   m-b-10",staticStyle:{padding:"4px 11px","font-size":"14px"},attrs:{id:"removeAllDevice",type:"button"},on:{click:e.quitarTodos}},[e._v("Deseleccionar todos")])]),s("div",{staticClass:"col-12"},[s("select",{staticClass:"searchable",attrs:{id:"custom-headers",multiple:"multiple"}},e._l(e.listDEviceC,(function(t){return s("option",{key:t.id,domProps:{value:t.id,selected:t.selectOptions}},[e._v(e._s(t.alias))])})),0)])]):e._e(),s("div",{staticClass:"col-12",staticStyle:{"margin-top":"40px","margin-bottom":"15px"},attrs:{id:"alertUser"}}),s("div",{staticClass:"col-12  float-right"},[e.Getdisabled?e._e():s("button",{staticClass:"btn btn-primary",attrs:{id:"editSubmit",type:"submit"},on:{click:function(t){return e.editarCampos(!0)}}},[e._v("Editar")]),e.Getdisabled?s("button",{staticClass:"btn btn-outline-primary ",attrs:{type:"button"},on:{click:function(t){return e.editarCampos(!1)}}},[e._v("Cancelar")]):e._e(),e.Getdisabled?s("button",{staticClass:"btn btn-primary ",attrs:{id:"registerSubmit",type:"submit"},on:{click:function(t){return e.editar()}}},[e._v("Guardar")]):e._e()])])},r=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"col-12 "},[s("h5",[e._v("Permisos")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"col-12"},[s("p",{staticClass:"text-muted",staticStyle:{"text-align":"justify","font-size":"12px","margin-top":"7px"}},[e._v("\n                              A continuación podras agregar o quitar los permisos que tendrá el usuario en la plataforma asi como que dispositivos que podrá visulizar y monitorear.")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"col-12 "},[s("h5",[e._v("Dispositivos a visualizar")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"col-12"},[s("p",{staticClass:"text-muted",staticStyle:{"text-align":"justify","font-size":"12px","margin-top":"7px"}},[e._v("\n                                  A continuación podrás seleccionar que dispositivos podrá visualizar el usuario")])])}],a=(s("7f7f"),s("8615"),s("ac6a"),s("7514"),s("96cf"),s("3b8d")),n=s("08e6"),o=s("d3e3"),c={name:"FormularioUsersM",mixins:[n["a"]],data:function(){return{userName:"",user:"",password:"",email:"",telefono:0,direc:"",tipoUser:0,apaterno:"",amaterno:"",dispositivosUser:[],dispositivos_list:[],accion:"",userID:"",userData:[],permisos:[],listZonaHoraria:[],zonaH:14,getDevicesUser:[],showDevice:!1,deviceesUs:[],listPermissions:[],notas:null,dynamicComponent:{component:null,properties:null,events:{}},visible:!1,setDisabled:!0}},created:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.accion=this.$route.params.accion,this.userID=this.$route.params.id,this.catPermissions();case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),mounted:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.$store.state.submenuActive="config",this.$store.state.itemSubmenuActive="itemUser",e.next=4,o["a"].$emit("NAVBAR_MenuOpciones","config","itemUser");case 4:return e.next=6,this.getDevices();case 6:return $("#containerPrincipal").css({"margin-left":this.$store.state.widthMenu}),$("#containerPrincipal").css({"margin-top":this.$store.state.topMenu}),e.next=10,$(".searchable").multiSelect({selectableHeader:"<input type='text' class='form-control' autocomplete='off' placeholder='Disponibles'>",selectionHeader:"<input type='text' class='form-control' autocomplete='off' placeholder='Asignados'>",afterInit:function(e){var t=this,s=t.$selectableUl.prev(),i=t.$selectionUl.prev(),r="#"+t.$container.attr("id")+" .ms-elem-selectable:not(.ms-selected)",a="#"+t.$container.attr("id")+" .ms-elem-selection.ms-selected";t.qs1=s.quicksearch(r).on("keydown",(function(e){if(40===e.which)return t.$selectableUl.focus(),!1})),t.qs2=i.quicksearch(a).on("keydown",(function(e){if(40==e.which)return t.$selectionUl.focus(),!1}))},afterSelect:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:s=parseInt(t),i=this.dispositivosUser.find((function(e){return e==s})),console.debug("DISP",i),void 0==i&&this.dispositivosUser.push(s);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}().bind(this),afterDeselect:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:parseInt(t),this.dispositivosUser.filter((function(e,i){if(e==t)return s=i,!0})),this.dispositivosUser.splice(s,1);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}().bind(this)});case 10:$(".js-example-basic-multiple").select2({placeholder:"Selecciona permisos",tags:!0,tokenSeparators:[","," "]}),this.$store.state.loader=!1,$(".sw-btn-next").click((function(){window.scrollTo(0,0)})),$(".sw-btn-prev").click((function(){window.scrollTo(0,0)})),this.editarCampos(!1),this.$store.state.loader=!1;case 16:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),methods:{editarCampos:function(e){console.debug("editarCampos",e),this.setDisabled=e,1==e&&($("#permisos").removeAttr("disabled"),$("#addAllDevice").removeAttr("disabled"),$("#removeAllDevice").removeAttr("disabled"),$("#custom-headers").removeAttr("disabled"),$("#editSubmit").html("Guardar")),0==e&&($("#permisos").attr("disabled","disabled"),$("#addAllDevice").attr("disabled","disabled"),$("#removeAllDevice").attr("disabled","disabled"),$("#custom-headers").attr("disabled","disabled"),$("#editSubmit").html("Editar"))},agregarTodos:function(){var e=this;return console.debug("ENTRA TODOS"),this.dispositivos_list.forEach((function(t){var s=e.dispositivosUser.find((function(e){return e==t.id}));console.debug("DISP",s),void 0==s&&e.dispositivosUser.push(t.id)})),$(".searchable").multiSelect("select_all"),!1},quitarTodos:function(){return console.debug("quitar TODOS"),$(".searchable").multiSelect("deselect_all"),this.dispositivosUser=[],!1},getDevices:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t,s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=Object.values(this.$store.state.devices.devices),this.dispositivos_list=[],t.forEach((function(e){s.dispositivos_list.push({id:parseInt(e.id),alias:e.alias,selectOptions:!1})})),"editar"!==this.accion){e.next=8;break}return e.next=6,this.getUser(this.userID);case 6:e.next=9;break;case 8:this.showDevice=!0;case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),catPermissions:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t,s,i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getRequest("permissions");case 2:t=e.sent,!0===t.success&&(s=t.data.permissions,1==this.$store.state.clientType?s.forEach((function(e){1!=e.id&&16!=e.id&&i.listPermissions.push({id:e.id,code:e.code,name:e.name})})):this.listPermissions=s);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),editar:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t,s,i,r,n,o,c,u,l,d,p=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=$("#permisos").val(),s=[],1==this.$store.state.clientType&&(s.push(1),s.push(16)),t.forEach((function(e){e=parseInt(e),s.push(e)})),i=2,r={userType:i,permissions:s},n={},n["user"]=r,e.next=10,this.putRequest("users/"+this.userID,n);case 10:if(o=e.sent,!0!==o.success){e.next=26;break}return!1,!1,c=this.deviceesUs,c.forEach(function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,p.deleteRequest("users/"+p.userID+"/devices/"+t.id);case 2:s=e.sent,!0===s.success;case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),u={},u["devices"]=Object.values(this.dispositivosUser),e.next=20,this.postRequest("users/"+this.userID+"/devices",u);case 20:l=e.sent,!0===l.success,$("#alertUser").html("<div class='alert alert-success alert-dismissible fade show' role='alert' style='text-align: initial;'><strong>Excelente! </strong>Se ha actualizado el usuario<button type='button' class='close' data-dismiss='alert' aria-label='Close' style='padding-top: 0px;'><span aria-hidden='true'>&times;</span></button></div>"),setTimeout((function(){$("#alertUser").html(""),p.getUser(p.userID)}),3e3),e.next=39;break;case 26:d="",e.t0=o.error.title,e.next="USER_EXISTS"===e.t0?30:"EMAIL_EXISTS"===e.t0?32:"UNAUTHORIZED"===e.t0?34:36;break;case 30:return d="El usuario ya existe",e.abrupt("break",38);case 32:return d="El correo electrónico ya existe",e.abrupt("break",38);case 34:return d="No cuenta con los permisos para realizar la accion",e.abrupt("break",38);case 36:return d="No se ha actualizado el usuario",e.abrupt("break",38);case 38:$("#alertUser").html("<div class='alert alert-danger alert-dismissible fade show' role='alert' style='text-align: initial;'><strong>Error! </strong>".concat(d,"<button type='button' class='close' data-dismiss='alert' aria-label='Close' style='padding-top: 0px;'><span aria-hidden='true'>&times;</span></button></div>"));case 39:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getUser:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var s,i,r,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getRequest("users/"+t);case 2:s=e.sent,!0===s.success&&(this.userData=s.data.user,this.userName=this.userData.name,this.user=this.userData.username,this.email=this.userData.email,this.telefono=this.userData.phone,this.direc=this.userData.address,this.tipoUser=this.userData.userType,this.apaterno=this.userData.paternalSurname,this.amaterno=this.userData.maternalSurname,this.zonaH=this.userData.timezoneID,this.notas=this.userData.notes,this.permisos=this.userData.permissions,i=[],this.permisos.forEach((function(e){var t=e.id;i.push(t)})),this.permisos=Object.values(i),$("#permisos").val(this.permisos),this.getDevicesUser=[],this.dispositivosUser=[],r=s.data.devices,this.deviceesUs=s.data.devices,r.forEach((function(e){var t;a.dispositivos_list.filter((function(s,i){if(s.id==e.id)return t=i,!0})),a.dispositivos_list.splice(t,1)})),r.forEach((function(e){a.dispositivos_list.push({id:parseInt(e.id),alias:e.alias,selectOptions:!0}),a.dispositivosUser.push(parseInt(e.id))}))),this.showDevice=!0;case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),cancel:function(){this.$router.push("/listaUsers")}},computed:{Getdisabled:function(){return this.setDisabled},listDEviceC:function(){return this.dispositivos_list},getTypeUser:function(){return this.$store.state.userType,this.$store.state.clientType,this.dispositivos_list}}},u=c,l=(s("6624"),s("2877")),d=Object(l["a"])(u,i,r,!1,null,null,null);t["default"]=d.exports}}]);
//# sourceMappingURL=chunk-ab7d87a8.fa82d0bf.js.map