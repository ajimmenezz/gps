(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4b427409"],{"7b36":function(t,e,r){"use strict";r.r(e);var s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"row",staticStyle:{"margin-bottom":"150px"}},[r("div",{staticClass:"col-12"},[r("h5",{staticClass:"float-left",staticStyle:{"font-size":"20px","padding-bottom":"10px"}},[1==this.tipo?r("b",[t._v("Nueva transferencia")]):t._e(),2==this.tipo?r("b",[t._v("Nueva devolución")]):t._e()])]),r("div",{staticClass:"col-12 card"},[r("div",{staticClass:"card-body"},[r("div",{staticClass:"row"},[t._m(0),2==this.$store.state.clientType?r("div",{staticClass:"col-12 col-md-4 float-left",staticStyle:{"margin-bottom":"15px"}},[r("div",{staticClass:"form-group"},[r("label",{attrs:{for:"typeTranf"}},[t._v("Tipo de tranferencia")]),r("select",{directives:[{name:"model",rawName:"v-model",value:t.typeTranf,expression:"typeTranf"}],staticClass:"form-control",attrs:{id:"typeTranf",valor:t.typeTranf,required:""},on:{change:[function(e){var r=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.typeTranf=e.target.multiple?r:r[0]},function(e){return t.tipoTranf()}]}},[r("option",{attrs:{value:""}},[t._v("Selecciona")]),t._l(t.listCatypeTranf,(function(e){return r("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.type))])}))],2)])]):t._e(),r("div",{staticClass:"col-12 text-left"},[r("ul",{staticClass:"nav nav-tabs",attrs:{role:"tablist"}},[r("li",{staticClass:"nav-item"},[r("a",{staticClass:"nav-link active cursor",attrs:{"data-toggle":"tab",role:"tab","aria-selected":"true"},on:{click:function(e){return t.showProductSelector()}}},[t._v("Agregar Producto\n              ")])])])]),r("div",{staticClass:"col-12",staticStyle:{border:"solid 1px lightgrey",padding:"10px"}},[r(t.currentProductSelectorTab,{tag:"component",on:{OnProductSelected:t.OnProductSelected,OnProductsSelected:t.OnProductsSelected}})],1)]),r("div",{staticClass:"row",staticStyle:{"margin-top":"70px"}},[r("div",{staticClass:"col-12 text-left",staticStyle:{"font-size":"16px"}},[1==this.tipo?r("b",[t._v("Productos seleccionados a transferir")]):t._e(),2==this.tipo?r("b",[t._v("Productos seleccionados a devolver")]):t._e()]),r("div",{staticClass:"col-12",staticStyle:{"margin-top":"15px"}},[r("table",{staticClass:"table table-hover header_fijo"},[t._m(1),r("tbody",t._l(t.products,(function(e,s){return r("tr",{key:s},[r("td",[t._v(t._s(e.productType))]),r("td",[t._v(t._s(e.factory))]),r("td",[t._v(t._s(e.id))]),r("td",[r("span",[r("i",{staticClass:"icon icon-md universalicon-trash-2 colorText-red cursor",on:{click:function(r){return t.removeProduct(e.productTypeID,e.id)}}})])])])})),0)])])]),r("div",{staticClass:"row",staticStyle:{"margin-top":"50px"}},[t._m(2),r("div",{staticClass:"col-12 float-left",staticStyle:{"padding-top":"21px"}},[r("config-input",{attrs:{id:"notes",label:"Notas",typeinput:"text",placeholder:"Notas",required:"false",valor:t.notas},model:{value:t.notas,callback:function(e){t.notas="string"===typeof e?e.trim():e},expression:"notas"}})],1),r("div",{staticClass:"col-6 col-lg-5 text-left"},[2!=this.tipo?r("m-select",{ref:"customerSelect",attrs:{data:t.customer.customers,filterby:"name",title:t.titleCliente},on:{selectionChanged:t.OnCustomerSelected}}):t._e()],1),r("div",{staticClass:"col-6 col-lg-7 text-right align-self-end"},[r("button",{staticClass:"btn btn-sm btn-secondary",attrs:{type:"button"},on:{click:t.goReturn}},[t._v("CANCELAR")]),r("button",{staticClass:"btn btn-sm btn-primary",attrs:{type:"button",disabled:!t.confirmSaleBtnEnabled},on:{click:t.confirmSale}},[t._v("CONFIRMAR")])])])])])])},n=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"col-12"},[r("p",{staticClass:"text-muted",staticStyle:{"text-align":"justify","font-size":"12px","margin-top":"7px"}},[t._v("\n           A continuación podrás transferir producto a tus clientes o devolver productos a tus proveedores")])])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("thead",[r("tr",[r("th",[t._v("Tipo de Producto")]),r("th",[t._v("Marca")]),r("th",[t._v("IMEI/Serie")]),r("th",[t._v("Acciones")])])])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"col-12"},[r("hr")])}],a=(r("20d6"),r("ac6a"),r("96cf"),r("3b8d")),i=r("08e6"),o=r("b381"),c=r("8150"),l=r("d3e3"),u={name:"NewTransDev",mixins:[i["a"]],components:{productSelector:c["a"],mSelect:o["a"]},created:function(){this.$store.state.loader=!0,this.tipo=this.$route.params.tipo,2==this.$store.state.clientType&&this.catTypeTransfer()},mounted:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.$store.state.seccionMenu="almacen",t.next=3,l["a"].$emit("NAVBAR_MenuSimple","almacen");case 3:$("#containerPrincipal").css({"margin-left":this.$store.state.widthMenu}),$("#containerPrincipal").css({"margin-top":this.$store.state.topMenu}),2==this.$store.state.clientType&&(this.titleCliente="Seleccione cliente"),3==this.$store.state.clientType&&(this.titleCliente="Seleccione distribuidor"),1!=this.$store.state.clientType&&this.getCustomers(),this.$store.state.loader=!1;case 9:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),data:function(){return{currentProductSelectorTab:c["a"],products:[],customer:{customers:[],selected:""},confirmSaleBtnEnabled:!0,titleCliente:null,notas:null,listCatypeTranf:null,typeTranf:1,tipo:null}},methods:{catTypeTransfer:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.$store.state.loader=!0,t.next=3,this.getRequest("catalogs/transfers/types");case 3:e=t.sent,this.listCatypeTranf=e.data.types,this.$store.state.loader=!1;case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getCustomers:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.$store.state.loader=!0,t.next=3,this.getRequest("accounts");case 3:e=t.sent,this.customer.customers=e.data.customers,this.$store.state.loader=!1;case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),tipoTranf:function(){if(""==this.typeTranf)return notify("","Selecciona tipo de tranferencia","top","right","danger"),!1;this.tipo=this.typeTranf},showProductSelector:function(){this.currentProductSelectorTab=c["a"]},showKitSelector:function(){this.currentProductSelectorTab=null},OnProductSelected:function(t){console.debug("ProductSelected",t),this.addProduct(t)},OnProductsSelected:function(t){var e=this;t.forEach((function(t){e.addProduct(t)}))},OnCustomerSelected:function(t){this.customer.selected=t},addProduct:function(t){var e=this.products.findIndex((function(e){return e.id==t.id&&e.productTypeID==t.productTypeID}));-1==e?this.products.push(t):notify("","El producto ya se encuentra agregado","top","right","danger")},removeProduct:function(t,e){var r=this.products.findIndex((function(r){return r.id==e&&r.productTypeID==t}));r>-1&&this.products.splice(r,1)},confirmSale:function(){this.validateTransaction()&&this.processTransferencia()},goReturn:function(){this.$router.push("/transactions/store")},validateTransaction:function(){var t=!0;return this.products.length||(t=!1,notify("Error, ","Debe seleccionar por lo menos 1 producto","top","right","danger")),1==this.tipo&&(this.$refs.customerSelect.selectedItem&&-1!=this.$refs.customerSelect.selectedItem||(t=!1,notify("Error, ","Debe seleccionar el cliente","top","right","danger"))),""==this.typeTranf&&(notify("Errors","Selecciona tipo de tranferencia","top","right","danger"),t=!1),t},processTransferencia:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e,r,s,n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.$store.state.loader=!0,this.confirmSaleBtnEnabled=!1,e=[],this.products.forEach((function(t){var r={id:t.productID,type:t.productTypeID};e.push(r)})),r={transfer:{notes:this.notas},products:e},1==this.tipo&&(r.transfer.clientID=this.customer.selected.id),t.next=8,this.postRequest("transfers",r);case 8:if(s=t.sent,console.debug("DATOS",r),this.$store.state.loader=!1,!s.success){t.next=18;break}return 1==this.tipo&&notify("","Transferencia realizada con exito","top","right","success"),2==this.tipo&&notify("","Devolución realizada con exito","top","right","success"),t.next=16,setTimeout((function(){n.goReturn()}),3e3);case 16:t.next=21;break;case 18:1==this.tipo&&notify("","Error al realizar la transferencia","top","right","danger"),2==this.tipo&&notify("","Error al realizar la devolución","top","right","danger"),this.confirmSaleBtnEnabled=!0;case 21:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}},d=u,p=(r("a90f"),r("2877")),f=Object(p["a"])(d,s,n,!1,null,"09d30c09",null);e["default"]=f.exports},a90f:function(t,e,r){"use strict";var s=r("abfa"),n=r.n(s);n.a},abfa:function(t,e,r){}}]);
//# sourceMappingURL=chunk-4b427409.8ee6aad1.js.map