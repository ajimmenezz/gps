(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0f0681"],{"9bdf":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal fade ",attrs:{id:"modalDeviceParoMotor",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalCenterTitle","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog  ",attrs:{role:"document"}},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header"},[a("div",{staticClass:"col-12 col-fluid"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-9 text-left"},[a("h5",{staticClass:"modal-title",attrs:{id:"exampleModalCenterTitle"}},[a("b",[t._v(t._s(this.$store.state.devices.devices[this.$store.state.modal.datosDymanic.deviceImei].alias))])])]),t._m(0),a("div",{staticClass:"col-12 text-left"},[t._v("\n                Habilitar o deshabilitar motor\n              ")])])])]),a("div",{staticClass:"modal-body "},[a("div",{staticClass:"container"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-12 text-left"},[t._v("\n                  Seleccione la accion a realizar:\n                ")]),a("div",{staticClass:"col-12",staticStyle:{"margin-top":"20px","margin-bottom":"30px"}},[a("button",{staticClass:"btn btn-outline-danger float-left",attrs:{id:"disableEngineBtn",type:"button"},on:{click:function(e){return t.setEngineAction(!0)}}},[t._v("DESHABILITAR MOTOR")]),a("button",{staticClass:"btn btn-outline-success float-rigth",attrs:{id:"enableEngineBtn",type:"button"},on:{click:function(e){return t.setEngineAction(!1)}}},[t._v("HABILITAR MOTOR")])]),t.showAlert?a("div",{staticClass:"col-12"},[a("p",{staticClass:"float-left text-left"},[0==this.$store.state.modal.datosDymanic.stateParoMotor?a("span",[t._v("Se procedera a "),a("b",[t._v("habilitar")]),t._v(" el motor de la unidad  '"+t._s(this.$store.state.devices.devices[this.$store.state.modal.datosDymanic.deviceImei].alias)+"', esta accion permitira que el vehiculo pueda ser "),a("b",[t._v("encendido")]),t._v("."),a("br")]):a("span",[a("b",{staticClass:"color-danger"},[t._v("PRECAUCIÓN: ")]),t._v(" Se procedera a "),a("b",[t._v("detener")]),t._v(" la unidad '"+t._s(this.$store.state.devices.devices[this.$store.state.modal.datosDymanic.deviceImei].alias)+"',\n                      se recomienda realizar esta accion cuando la unidad este en "),a("b",[t._v("ALTO TOTAL.")]),a("br"),a("br")]),a("br"),a("small",[t._v("Una vez realizada la accion, está no se puede cancelar")])])]):t._e(),a("div",{staticClass:"col-12 float-left"},[a("div",{staticClass:"col-12"},[a("config-input",{attrs:{id:"passw",label:"Contraseña",typeinput:"password",placeholder:"Contraseña",required:"true"},model:{value:t.passwParoMotor,callback:function(e){t.passwParoMotor="string"===typeof e?e.trim():e},expression:"passwParoMotor"}})],1),this.$store.state.modal.datosDymanic.stateParoMotor?a("div",{staticClass:"col-12"},[a("config-input",{attrs:{id:"desc",label:"Motivo",typeinput:"text",placeholder:"Escriba el motivo en este campo",required:"true"},model:{value:t.descripcionParoMotor,callback:function(e){t.descripcionParoMotor="string"===typeof e?e.trim():e},expression:"descripcionParoMotor"}})],1):t._e(),a("div",{staticClass:"col-12",attrs:{id:"alertasM"}})])])])]),a("div",{staticClass:"modal-footer"},[a("div",{staticClass:"col-12"},[a("button",{staticClass:"btn btn-outline-primary",attrs:{id:"confirm",type:"button"},on:{click:function(e){return t.cancel()}}},[t._v("CANCELAR")]),a("button",{staticClass:"btn btn-primary",attrs:{id:"cancel",type:"button"},on:{click:function(e){return t.confirmModal()}}},[t._v("CONFIRMAR")])])])])])])},r=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-2 text-rigth"},[a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])}],i=(a("7f7f"),a("96cf"),a("3b8d")),o=(a("ac6a"),a("5df3"),a("f400"),a("d3e3")),n=a("08e6"),l={name:"ModalParoMotor",mixins:[n["a"]],data:function(){return{markers:new Map,passwParoMotor:null,descripcionParoMotor:null,showAlert:!1}},mounted:function(){$("#modalDeviceParoMotor").modal("show"),this.$store.state.modal.datosDymanic.stateParoMotor=!0},destroyed:function(){},methods:{setEngineAction:function(t){this.showAlert=!0,t?(this.$store.state.modal.datosDymanic.stateParoMotor=!0,$("#disableEngineBtn").removeClass("btn-outline-danger"),$("#disableEngineBtn").addClass("btn-danger"),$("#enableEngineBtn").addClass("btn-outline-success"),$("#enableEngineBtn").removeClass("btn-success")):(this.$store.state.modal.datosDymanic.stateParoMotor=!1,$("#disableEngineBtn").addClass("btn-outline-danger"),$("#disableEngineBtn").removeClass("btn-danger"),$("#enableEngineBtn").removeClass("btn-outline-success"),$("#enableEngineBtn").addClass("btn-success"))},toggleStateParoMotor:function(){this.$store.state.modal.datosDymanic.stateParoMotor=!this.$store.state.modal.datosDymanic.stateParoMotor},cancel:function(){$("#modalDeviceParoMotor").modal("hide"),this.$store.commit("CLEAR_MODAL_DINAMIC")},confirmModal:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,a,s,r,i,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.$store.state.ws.connected){t.next=4;break}return $("#alertasM").html("<div class='alert alert-danger alert-dismissible fade show' role='alert' style='text-align: initial;'><strong>Error! </strong>El servidor se encuentra fuera de línea, por lo que no se puede realizar la petición<button type='button' class='close' data-dismiss='alert' aria-label='Close' style='padding-top: 0px;'><span aria-hidden='true'>&times;</span></button></div>"),setTimeout((function(){$("#alertasM").html("")}),5e3),t.abrupt("return",!1);case 4:if(e=this.$store.state.modal.datosDymanic.deviceImei,a=this.$store.state.modal.datosDymanic.stateParoMotor,!a){t.next=33;break}if(null===this.descripcionParoMotor||""===this.descripcionParoMotor||null===this.passwParoMotor||""===this.passwParoMotor){t.next=29;break}if(s=this.passwordExist(),!s){t.next=25;break}return t.next=12,this.isPassword();case 12:if(r=t.sent,!r){t.next=21;break}return t.next=16,this.passwordExpired();case 16:i=t.sent,0!=i&&(o=Math.floor(Date.now()/1e3),console.debug("timestampsNow",o,i),i>=o?(console.debug("no ha expirado"),this.WS_SET_IGNITION(e,!1)):i=!1),i||($("#alertasM").html("<div class='alert alert-danger alert-dismissible fade show' role='alert' style='text-align: initial;'><strong>Error! </strong>La contraseña ha expirado. <br>Ve a configuracion > dispositivos, y reseta la contraseña<button type='button' class='close' data-dismiss='alert' aria-label='Close' style='padding-top: 0px;'><span aria-hidden='true'>&times;</span></button></div>"),setTimeout((function(){$("#alertasM").html("")}),5e3)),t.next=23;break;case 21:$("#alertasM").html("<div class='alert alert-danger alert-dismissible fade show' role='alert' style='text-align: initial;'><strong>Error! </strong>La contraseña no es correcta<button type='button' class='close' data-dismiss='alert' aria-label='Close' style='padding-top: 0px;'><span aria-hidden='true'>&times;</span></button></div>"),setTimeout((function(){$("#alertasM").html("")}),5e3);case 23:t.next=27;break;case 25:$("#alertasM").html("<div class='alert alert-danger alert-dismissible fade show' role='alert' style='text-align: initial;'><strong>Error! </strong>No se ha establecido una contraseña. <br>Ve a configuracion > dispositivos, y crea una contraseña<button type='button' class='close' data-dismiss='alert' aria-label='Close' style='padding-top: 0px;'><span aria-hidden='true'>&times;</span></button></div>"),setTimeout((function(){$("#alertasM").html("")}),5e3);case 27:t.next=31;break;case 29:$("#alertasM").html("<div class='alert alert-danger alert-dismissible fade show' role='alert' style='text-align: initial;'><strong>Error! </strong>Por favor ingresa todos los campos <button type='button' class='close' data-dismiss='alert' aria-label='Close' style='padding-top: 0px;'><span aria-hidden='true'>&times;</span></button></div>"),setTimeout((function(){$("#alertasM").html("")}),3e3);case 31:t.next=60;break;case 33:if(null===this.passwParoMotor||""===this.passwParoMotor){t.next=58;break}return console.debug("no tiene paro"),t.next=37,this.passwordExist();case 37:if(s=t.sent,!s){t.next=54;break}return t.next=41,this.isPassword();case 41:if(r=t.sent,!r){t.next=50;break}return t.next=45,this.passwordExpired();case 45:i=t.sent,0!=i&&(o=Math.floor(Date.now()/1e3),console.debug("timestampsNow",o,i),i>=o?(console.debug("no ha expirado"),this.WS_SET_IGNITION(e,!0)):i=!1),i||($("#alertasM").html("<div class='alert alert-danger alert-dismissible fade show' role='alert' style='text-align: initial;'><strong>Error! </strong>La contraseña ha expirado. <br>Ve a configuracion > dispositivos, y reseta la contraseña<button type='button' class='close' data-dismiss='alert' aria-label='Close' style='padding-top: 0px;'><span aria-hidden='true'>&times;</span></button></div>"),setTimeout((function(){$("#alertasM").html("")}),5e3)),t.next=52;break;case 50:$("#alertasM").html("<div class='alert alert-danger alert-dismissible fade show' role='alert' style='text-align: initial;'><strong>Error! </strong>La contraseña no es correcta<button type='button' class='close' data-dismiss='alert' aria-label='Close' style='padding-top: 0px;'><span aria-hidden='true'>&times;</span></button></div>"),setTimeout((function(){$("#alertasM").html("")}),5e3);case 52:t.next=56;break;case 54:$("#alertasM").html("<div class='alert alert-danger alert-dismissible fade show' role='alert' style='text-align: initial;'><strong>Error! </strong>No se ha establecido una contraseña. <br>Ve a configuracion > dispositivos, y crea una contraseña<button type='button' class='close' data-dismiss='alert' aria-label='Close' style='padding-top: 0px;'><span aria-hidden='true'>&times;</span></button></div>"),setTimeout((function(){$("#alertasM").html("")}),5e3);case 56:t.next=60;break;case 58:$("#alertasM").html("<div class='alert alert-danger alert-dismissible fade show' role='alert' style='text-align: initial;'><strong>Error! </strong>Por favor ingresa la contraseña <button type='button' class='close' data-dismiss='alert' aria-label='Close' style='padding-top: 0px;'><span aria-hidden='true'>&times;</span></button></div>"),setTimeout((function(){$("#alertasM").html("")}),3e3);case 60:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),WS_SET_IGNITION:function(t,e){$("#modalDeviceParoMotor").modal("hide");var a={imei:t,status:e,eventPassword:this.passwParoMotor};this.$store.dispatch("ws/SET_ENGINE",a)},isPassword:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={password:this.passwParoMotor},t.next=3,this.getRequest("configuration/eventpassword/validate",a);case 3:return s=t.sent,console.debug("requesPasswordValidate",s,a),e=!0===s.success&&s.data.isValidEventPassword,t.abrupt("return",e);case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),passwordExist:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.getRequest("configuration/eventpassword/exists");case 2:return a=t.sent,console.debug("requesPassword",a),e=!0===a.success&&a.data.eventPasswordExists,t.abrupt("return",e);case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),passwordExpired:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.getRequest("configuration/eventpassword/expiration");case 2:return a=t.sent,console.debug("expiration",a),e=!0===a.success&&a.data.timestampExpiration,this.PasswordExpired=e,t.abrupt("return",e);case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),DeviceParoMotor:function(t,e){var a,s=this;0==e?(a="MARKER_CANCEL_RED",$("#alertasM").html("<div class='alert alert-success alert-dismissible fade show' role='alert' style='text-align: initial;'><strong>Excelente! </strong>Se ha realizado el paro de motor</div>")):(a=this.$store.state.devices.devices[t].marker.name,$("#alertasM").html("<div class='alert alert-success alert-dismissible fade show' role='alert' style='text-align: initial;'><strong>Excelente! </strong>Se ha cancelado el paro de motor</div>")),this.$store.state.devices.devices[t].iconGestionDevices=!1,setTimeout((function(){$("#modalDeviceParoMotor").modal("hide"),s.$store.commit("CLEAR_MODAL_DINAMIC")}),1e3),setTimeout((function(){s.$store.state.devices.devices[t].report.states.engineEnabled=e,s.$store.state.devices.devices[t].iconGestionDevices=!0;var r={imei:t,markerName:a};o["a"].$emit("SET_MARKER_ICON",r)}),5e3)}},computed:{}},d=l,c=a("2877"),u=Object(c["a"])(d,s,r,!1,null,null,null);e["default"]=u.exports}}]);
//# sourceMappingURL=chunk-2d0f0681.67b4f873.js.map